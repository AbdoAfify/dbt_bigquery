[0m16:56:10.171409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bebd90>]}


============================== 16:56:10.174130 | c3f7e489-5dd6-4538-b0fd-c4924edd2d95 ==============================
[0m16:56:10.174130 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:56:10.174391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:56:10.185603 [info ] [MainThread]: dbt version: 1.10.2
[0m16:56:10.185837 [info ] [MainThread]: python version: 3.13.4
[0m16:56:10.185992 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:56:10.186101 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m16:56:12.036227 [info ] [MainThread]: Using profiles dir at /Users/abdelrhmanafify/.dbt
[0m16:56:12.036493 [info ] [MainThread]: Using profiles.yml file at /Users/abdelrhmanafify/.dbt/profiles.yml
[0m16:56:12.036621 [info ] [MainThread]: Using dbt_project.yml file at /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/dbt_project.yml
[0m16:56:12.036727 [info ] [MainThread]: adapter type: bigquery
[0m16:56:12.036830 [info ] [MainThread]: adapter version: 1.9.2
[0m16:56:12.073317 [info ] [MainThread]: Configuration:
[0m16:56:12.073549 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:56:12.073680 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:56:12.073785 [info ] [MainThread]: Required dependencies:
[0m16:56:12.073958 [debug] [MainThread]: Executing "git --help"
[0m16:56:12.092581 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:56:12.093107 [debug] [MainThread]: STDERR: "b''"
[0m16:56:12.093262 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:56:12.093396 [info ] [MainThread]: Connection:
[0m16:56:12.093561 [info ] [MainThread]:   method: oauth
[0m16:56:12.093669 [info ] [MainThread]:   database: ace-amplifier-463712-b1
[0m16:56:12.093782 [info ] [MainThread]:   execution_project: ace-amplifier-463712-b1
[0m16:56:12.093877 [info ] [MainThread]:   schema: sales_dataset
[0m16:56:12.093965 [info ] [MainThread]:   location: EU
[0m16:56:12.094055 [info ] [MainThread]:   priority: interactive
[0m16:56:12.094148 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:56:12.094237 [info ] [MainThread]:   impersonate_service_account: None
[0m16:56:12.094327 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:56:12.094414 [info ] [MainThread]:   job_retries: 1
[0m16:56:12.094504 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:56:12.094591 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:56:12.094677 [info ] [MainThread]:   timeout_seconds: 300
[0m16:56:12.094824 [info ] [MainThread]:   client_id: None
[0m16:56:12.094951 [info ] [MainThread]:   token_uri: None
[0m16:56:12.095050 [info ] [MainThread]:   compute_region: None
[0m16:56:12.095138 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:56:12.095228 [info ] [MainThread]:   gcs_bucket: None
[0m16:56:12.095315 [info ] [MainThread]:   dataproc_batch: None
[0m16:56:12.095569 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:56:12.196594 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:56:12.196913 [debug] [MainThread]: On debug: select 1 as id
[0m16:56:12.197057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:18.211167 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m16:56:18.213433 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m16:56:18.214183 [debug] [MainThread]: BigQuery adapter: Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
[0m16:56:18.215389 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:56:18.216146 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:56:18.216605 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:56:18.224885 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 8.083348, "process_in_blocks": "0", "process_kernel_time": 0.338584, "process_mem_max_rss": "361480192", "process_out_blocks": "0", "process_user_time": 1.389609}
[0m16:56:18.226079 [debug] [MainThread]: Command `dbt debug` failed at 16:56:18.225895 after 8.08 seconds
[0m16:56:18.226634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c6aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144cf2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b467a0>]}
[0m16:56:18.227183 [debug] [MainThread]: Flushing usage events
[0m16:56:19.188573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:30.309736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aebd90>]}


============================== 16:56:30.312327 | e1606b7f-5f98-4ea9-90ff-eccf3321ffa1 ==============================
[0m16:56:30.312327 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:56:30.312582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:56:30.321474 [info ] [MainThread]: dbt version: 1.10.2
[0m16:56:30.321670 [info ] [MainThread]: python version: 3.13.4
[0m16:56:30.321781 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:56:30.321880 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m16:56:31.418731 [info ] [MainThread]: Using profiles dir at /Users/abdelrhmanafify/.dbt
[0m16:56:31.418961 [info ] [MainThread]: Using profiles.yml file at /Users/abdelrhmanafify/.dbt/profiles.yml
[0m16:56:31.419085 [info ] [MainThread]: Using dbt_project.yml file at /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/dbt_project.yml
[0m16:56:31.419192 [info ] [MainThread]: adapter type: bigquery
[0m16:56:31.419292 [info ] [MainThread]: adapter version: 1.9.2
[0m16:56:31.455649 [info ] [MainThread]: Configuration:
[0m16:56:31.455888 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:56:31.456016 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:56:31.456122 [info ] [MainThread]: Required dependencies:
[0m16:56:31.456283 [debug] [MainThread]: Executing "git --help"
[0m16:56:31.469575 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:56:31.470052 [debug] [MainThread]: STDERR: "b''"
[0m16:56:31.470190 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:56:31.470324 [info ] [MainThread]: Connection:
[0m16:56:31.470478 [info ] [MainThread]:   method: oauth
[0m16:56:31.470576 [info ] [MainThread]:   database: ace-amplifier-463712-b1
[0m16:56:31.470667 [info ] [MainThread]:   execution_project: ace-amplifier-463712-b1
[0m16:56:31.470755 [info ] [MainThread]:   schema: sales_dataset
[0m16:56:31.470838 [info ] [MainThread]:   location: EU
[0m16:56:31.470924 [info ] [MainThread]:   priority: interactive
[0m16:56:31.471011 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:56:31.471095 [info ] [MainThread]:   impersonate_service_account: None
[0m16:56:31.471181 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:56:31.471264 [info ] [MainThread]:   job_retries: 1
[0m16:56:31.471347 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:56:31.471432 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:56:31.471513 [info ] [MainThread]:   timeout_seconds: 300
[0m16:56:31.471597 [info ] [MainThread]:   client_id: None
[0m16:56:31.471677 [info ] [MainThread]:   token_uri: None
[0m16:56:31.471759 [info ] [MainThread]:   compute_region: None
[0m16:56:31.471842 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:56:31.471923 [info ] [MainThread]:   gcs_bucket: None
[0m16:56:31.472004 [info ] [MainThread]:   dataproc_batch: None
[0m16:56:31.472249 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:56:31.556838 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:56:31.557158 [debug] [MainThread]: On debug: select 1 as id
[0m16:56:31.557300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:37.500792 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m16:56:37.501955 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m16:56:37.502535 [debug] [MainThread]: BigQuery adapter: Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
[0m16:56:37.503123 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:56:37.503587 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:56:37.503946 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:56:37.514514 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 7.232137, "process_in_blocks": "0", "process_kernel_time": 0.261543, "process_mem_max_rss": "363085824", "process_out_blocks": "0", "process_user_time": 1.3386}
[0m16:56:37.516349 [debug] [MainThread]: Command `dbt debug` failed at 16:56:37.516088 after 7.23 seconds
[0m16:56:37.516992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140d6aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140df6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140c4a7a0>]}
[0m16:56:37.517620 [debug] [MainThread]: Flushing usage events
[0m16:56:38.161247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:10.040288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7bd90>]}


============================== 18:27:10.043739 | 046abf2a-66cc-44d9-ade4-093a45b79c41 ==============================
[0m18:27:10.043739 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:27:10.043992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:10.054578 [info ] [MainThread]: dbt version: 1.10.2
[0m18:27:10.054768 [info ] [MainThread]: python version: 3.13.4
[0m18:27:10.054877 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m18:27:10.054973 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m18:27:11.348165 [info ] [MainThread]: Using profiles dir at /Users/abdelrhmanafify/.dbt
[0m18:27:11.348497 [info ] [MainThread]: Using profiles.yml file at /Users/abdelrhmanafify/.dbt/profiles.yml
[0m18:27:11.348650 [info ] [MainThread]: Using dbt_project.yml file at /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/dbt_project.yml
[0m18:27:11.348767 [info ] [MainThread]: adapter type: bigquery
[0m18:27:11.348870 [info ] [MainThread]: adapter version: 1.9.2
[0m18:27:11.384641 [info ] [MainThread]: Configuration:
[0m18:27:11.384862 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:27:11.384984 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:27:11.385084 [info ] [MainThread]: Required dependencies:
[0m18:27:11.385236 [debug] [MainThread]: Executing "git --help"
[0m18:27:11.407564 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:27:11.408059 [debug] [MainThread]: STDERR: "b''"
[0m18:27:11.408214 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:27:11.408351 [info ] [MainThread]: Connection:
[0m18:27:11.408505 [info ] [MainThread]:   method: oauth
[0m18:27:11.408608 [info ] [MainThread]:   database: ace-amplifier-463712-b1
[0m18:27:11.408703 [info ] [MainThread]:   execution_project: ace-amplifier-463712-b1
[0m18:27:11.408794 [info ] [MainThread]:   schema: sales_dataset
[0m18:27:11.408881 [info ] [MainThread]:   location: EU
[0m18:27:11.408970 [info ] [MainThread]:   priority: interactive
[0m18:27:11.409059 [info ] [MainThread]:   maximum_bytes_billed: None
[0m18:27:11.409148 [info ] [MainThread]:   impersonate_service_account: None
[0m18:27:11.409236 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m18:27:11.409321 [info ] [MainThread]:   job_retries: 1
[0m18:27:11.409407 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m18:27:11.409495 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m18:27:11.409578 [info ] [MainThread]:   timeout_seconds: 300
[0m18:27:11.409666 [info ] [MainThread]:   client_id: None
[0m18:27:11.409749 [info ] [MainThread]:   token_uri: None
[0m18:27:11.409832 [info ] [MainThread]:   compute_region: None
[0m18:27:11.409915 [info ] [MainThread]:   dataproc_cluster_name: None
[0m18:27:11.409999 [info ] [MainThread]:   gcs_bucket: None
[0m18:27:11.410081 [info ] [MainThread]:   dataproc_batch: None
[0m18:27:11.410333 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:27:11.494850 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m18:27:11.495141 [debug] [MainThread]: On debug: select 1 as id
[0m18:27:11.495278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:20.517938 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m18:27:20.519028 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m18:27:20.519526 [debug] [MainThread]: BigQuery adapter: Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
[0m18:27:20.520081 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:27:20.520605 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:27:20.521029 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:27:20.532360 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 10.523616, "process_in_blocks": "0", "process_kernel_time": 0.302582, "process_mem_max_rss": "363003904", "process_out_blocks": "0", "process_user_time": 1.314412}
[0m18:27:20.533806 [debug] [MainThread]: Command `dbt debug` failed at 18:27:20.533630 after 10.53 seconds
[0m18:27:20.534280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e6aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118efe450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d4a7a0>]}
[0m18:27:20.534766 [debug] [MainThread]: Flushing usage events
[0m18:27:21.318415 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:48.059404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032e3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479fc50>]}


============================== 18:29:48.062769 | 99fc928a-9b17-4a48-a4e5-2e6771c00b28 ==============================
[0m18:29:48.062769 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:29:48.063038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:29:48.074326 [info ] [MainThread]: dbt version: 1.10.2
[0m18:29:48.074559 [info ] [MainThread]: python version: 3.13.4
[0m18:29:48.074677 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m18:29:48.074779 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m18:29:49.357025 [info ] [MainThread]: Using profiles dir at /Users/abdelrhmanafify/.dbt
[0m18:29:49.357281 [info ] [MainThread]: Using profiles.yml file at /Users/abdelrhmanafify/.dbt/profiles.yml
[0m18:29:49.357410 [info ] [MainThread]: Using dbt_project.yml file at /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/dbt_project.yml
[0m18:29:49.357519 [info ] [MainThread]: adapter type: bigquery
[0m18:29:49.357642 [info ] [MainThread]: adapter version: 1.9.2
[0m18:29:49.393897 [info ] [MainThread]: Configuration:
[0m18:29:49.394137 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:29:49.394263 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:29:49.394374 [info ] [MainThread]: Required dependencies:
[0m18:29:49.394536 [debug] [MainThread]: Executing "git --help"
[0m18:29:49.413487 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:29:49.413977 [debug] [MainThread]: STDERR: "b''"
[0m18:29:49.414154 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:29:49.414283 [info ] [MainThread]: Connection:
[0m18:29:49.414448 [info ] [MainThread]:   method: oauth
[0m18:29:49.414545 [info ] [MainThread]:   database: ace-amplifier-463712-b1
[0m18:29:49.414643 [info ] [MainThread]:   execution_project: ace-amplifier-463712-b1
[0m18:29:49.414732 [info ] [MainThread]:   schema: sales_dataset
[0m18:29:49.414822 [info ] [MainThread]:   location: EU
[0m18:29:49.414911 [info ] [MainThread]:   priority: interactive
[0m18:29:49.414999 [info ] [MainThread]:   maximum_bytes_billed: None
[0m18:29:49.415088 [info ] [MainThread]:   impersonate_service_account: None
[0m18:29:49.415173 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m18:29:49.415260 [info ] [MainThread]:   job_retries: 1
[0m18:29:49.415344 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m18:29:49.415510 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m18:29:49.415662 [info ] [MainThread]:   timeout_seconds: 300
[0m18:29:49.415772 [info ] [MainThread]:   client_id: None
[0m18:29:49.415868 [info ] [MainThread]:   token_uri: None
[0m18:29:49.416004 [info ] [MainThread]:   compute_region: None
[0m18:29:49.416160 [info ] [MainThread]:   dataproc_cluster_name: None
[0m18:29:49.416260 [info ] [MainThread]:   gcs_bucket: None
[0m18:29:49.416412 [info ] [MainThread]:   dataproc_batch: None
[0m18:29:49.416728 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:29:49.504629 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m18:29:49.504911 [debug] [MainThread]: On debug: select 1 as id
[0m18:29:49.505042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:51.010089 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:36298455-aa01-4757-9df9-ffb9503c4266&page=queryresults
[0m18:29:51.463957 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:29:51.465381 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:29:51.473946 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4465108, "process_in_blocks": "0", "process_kernel_time": 0.346084, "process_mem_max_rss": "366395392", "process_out_blocks": "0", "process_user_time": 1.344389}
[0m18:29:51.475121 [debug] [MainThread]: Command `dbt debug` succeeded at 18:29:51.474897 after 3.45 seconds
[0m18:29:51.475672 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:29:51.476289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b6b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116bf68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a47df0>]}
[0m18:29:51.476909 [debug] [MainThread]: Flushing usage events
[0m18:29:52.155048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:42:55.506081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ebc50>]}


============================== 21:42:55.509625 | 46481002-0d5a-4b8c-800f-e1719db49e4b ==============================
[0m21:42:55.509625 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:42:55.509918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:42:57.095261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46481002-0d5a-4b8c-800f-e1719db49e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057236f0>]}
[0m21:42:57.116178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46481002-0d5a-4b8c-800f-e1719db49e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14005f130>]}
[0m21:42:57.116435 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:42:57.208363 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:42:57.208740 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:42:57.208897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46481002-0d5a-4b8c-800f-e1719db49e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1400e5a50>]}
[0m21:42:57.583757 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m21:42:57.584309 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m21:42:57.620576 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sales_analytics.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m21:42:57.620842 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sales_analytics.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m21:42:57.620990 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sales_analytics.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:42:57.621117 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sales_analytics.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:42:57.653514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46481002-0d5a-4b8c-800f-e1719db49e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140594f50>]}
[0m21:42:57.683035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:42:57.684204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:42:57.693850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46481002-0d5a-4b8c-800f-e1719db49e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141190f30>]}
[0m21:42:57.694031 [info ] [MainThread]: Found 2 models, 493 macros
[0m21:42:57.694153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46481002-0d5a-4b8c-800f-e1719db49e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140616820>]}
[0m21:42:57.694955 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:42:57.695168 [debug] [MainThread]: Command end result
[0m21:42:57.704155 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:42:57.704750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:42:57.705940 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m21:42:57.732802 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2569008, "process_in_blocks": "0", "process_kernel_time": 0.34307, "process_mem_max_rss": "373997568", "process_out_blocks": "0", "process_user_time": 1.794928}
[0m21:42:57.733149 [debug] [MainThread]: Command `dbt compile` succeeded at 21:42:57.733105 after 2.26 seconds
[0m21:42:57.733335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141394940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141394b50>]}
[0m21:42:57.733476 [debug] [MainThread]: Flushing usage events
[0m21:42:58.534243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:46.503063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104067380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ebc50>]}


============================== 21:44:46.506022 | cfb4a58e-26b2-4dc7-8920-b429698f4361 ==============================
[0m21:44:46.506022 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:44:46.506300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:47.826373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfb4a58e-26b2-4dc7-8920-b429698f4361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047276f0>]}
[0m21:44:47.847619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfb4a58e-26b2-4dc7-8920-b429698f4361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ec5f130>]}
[0m21:44:47.847910 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:44:47.936443 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:44:47.993663 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m21:44:48.015918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfb4a58e-26b2-4dc7-8920-b429698f4361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ece6150>]}
[0m21:44:48.038844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:44:48.040027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:44:48.050287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfb4a58e-26b2-4dc7-8920-b429698f4361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f2fd220>]}
[0m21:44:48.050468 [info ] [MainThread]: Found 2 models, 493 macros
[0m21:44:48.050599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfb4a58e-26b2-4dc7-8920-b429698f4361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13edaa510>]}
[0m21:44:48.051176 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:44:48.051904 [debug] [MainThread]: Command end result
[0m21:44:48.060413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:44:48.061069 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:44:48.062514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m21:44:48.065150 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.5910822, "process_in_blocks": "0", "process_kernel_time": 0.307375, "process_mem_max_rss": "368508928", "process_out_blocks": "0", "process_user_time": 1.396631}
[0m21:44:48.065414 [debug] [MainThread]: Command `dbt compile` succeeded at 21:44:48.065377 after 1.59 seconds
[0m21:44:48.065566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f45bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f32f050>]}
[0m21:44:48.065695 [debug] [MainThread]: Flushing usage events
[0m21:44:48.888063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:46.072130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032df380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479bc50>]}


============================== 21:45:46.075053 | d6e6e5c2-e19d-4a8c-bd65-8f226ebf730f ==============================
[0m21:45:46.075053 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:45:46.075313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m21:45:47.424956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6e6e5c2-e19d-4a8c-bd65-8f226ebf730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ad36f0>]}
[0m21:45:47.446174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6e6e5c2-e19d-4a8c-bd65-8f226ebf730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11695f130>]}
[0m21:45:47.446453 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:45:47.537709 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:45:47.589699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:45:47.589899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:45:47.600051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6e6e5c2-e19d-4a8c-bd65-8f226ebf730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169e5d50>]}
[0m21:45:47.623338 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:45:47.624488 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:45:47.633937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6e6e5c2-e19d-4a8c-bd65-8f226ebf730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116df5220>]}
[0m21:45:47.634143 [info ] [MainThread]: Found 2 models, 493 macros
[0m21:45:47.634276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e6e5c2-e19d-4a8c-bd65-8f226ebf730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116aa9630>]}
[0m21:45:47.634890 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:45:47.635669 [debug] [MainThread]: Command end result
[0m21:45:47.644935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:45:47.645656 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:45:47.647097 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m21:45:47.649580 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.605673, "process_in_blocks": "0", "process_kernel_time": 0.312739, "process_mem_max_rss": "366395392", "process_out_blocks": "0", "process_user_time": 1.402742}
[0m21:45:47.649797 [debug] [MainThread]: Command `dbt compile` succeeded at 21:45:47.649761 after 1.61 seconds
[0m21:45:47.649945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f77ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e7e510>]}
[0m21:45:47.650074 [debug] [MainThread]: Flushing usage events
[0m21:45:48.237990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:54.619316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eebc50>]}


============================== 21:52:54.623152 | 89bb57fb-0002-419a-ac67-f74f1d2a1bbb ==============================
[0m21:52:54.623152 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:52:54.623423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select sales_final', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:55.945451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89bb57fb-0002-419a-ac67-f74f1d2a1bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d236f0>]}
[0m21:52:55.966447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89bb57fb-0002-419a-ac67-f74f1d2a1bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ed5f130>]}
[0m21:52:55.966715 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:52:56.055726 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:52:56.107087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m21:52:56.107349 [debug] [MainThread]: Partial parsing: added file: sales_analytics://models/dbt_projcet.yml
[0m21:52:56.107507 [debug] [MainThread]: Partial parsing: updated file: sales_analytics://models/staging/stage_sales.sql
[0m21:52:56.107644 [debug] [MainThread]: Partial parsing: updated file: sales_analytics://models/example/Mart/sales_final.sql
[0m21:52:56.107778 [debug] [MainThread]: Partial parsing: updated file: sales_analytics://macros/dynamic_partition.sql
[0m21:52:56.198803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89bb57fb-0002-419a-ac67-f74f1d2a1bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f3e4b50>]}
[0m21:52:56.223073 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:52:56.224428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:52:56.234162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89bb57fb-0002-419a-ac67-f74f1d2a1bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f2f7110>]}
[0m21:52:56.234397 [info ] [MainThread]: Found 2 models, 494 macros
[0m21:52:56.234537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89bb57fb-0002-419a-ac67-f74f1d2a1bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee48c90>]}
[0m21:52:56.235148 [info ] [MainThread]: 
[0m21:52:56.235287 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:52:56.235387 [info ] [MainThread]: 
[0m21:52:56.235583 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:52:56.237341 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m21:52:56.237485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:57.514804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89bb57fb-0002-419a-ac67-f74f1d2a1bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f433d40>]}
[0m21:52:57.515918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:57.522800 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m21:52:57.523538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m21:52:57.524015 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m21:52:57.529842 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m21:52:57.531081 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m21:52:57.531341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:57.532028 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m21:52:57.533124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:57.533384 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m21:52:57.533716 [debug] [MainThread]: Command end result
[0m21:52:57.546883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:52:57.547867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:52:57.552545 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m21:52:57.552777 [info ] [MainThread]: Compiled node 'sales_final' is:
SELECT
  country,
  product_name,
  COUNT(order_id) AS total_orders,
  SUM(amount) AS total_revenue,
  CASE
    WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH) THEN 'recent'
    ELSE 'historical'
  END AS partition_group
FROM `local-pointer-452713-p9.sales_dataset.stg_sales`
GROUP BY country, product_name, partition_group
[0m21:52:57.555897 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.9680858, "process_in_blocks": "0", "process_kernel_time": 0.332845, "process_mem_max_rss": "373653504", "process_out_blocks": "0", "process_user_time": 1.506266}
[0m21:52:57.556137 [debug] [MainThread]: Command `dbt compile` succeeded at 21:52:57.556091 after 2.97 seconds
[0m21:52:57.556318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f41d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f41d650>]}
[0m21:52:57.556479 [debug] [MainThread]: Flushing usage events
[0m21:52:58.222924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:17.086487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bebc50>]}


============================== 21:53:17.088642 | 6eaff0c8-4c63-426d-a1e5-ddf274a205c8 ==============================
[0m21:53:17.088642 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:53:17.088892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:53:18.112602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eaff0c8-4c63-426d-a1e5-ddf274a205c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053236f0>]}
[0m21:53:18.133797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eaff0c8-4c63-426d-a1e5-ddf274a205c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa5f130>]}
[0m21:53:18.134064 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:53:18.224174 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:53:18.273752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:53:18.273990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:53:18.284882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eaff0c8-4c63-426d-a1e5-ddf274a205c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fae5d50>]}
[0m21:53:18.308055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:53:18.309134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:53:18.317618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eaff0c8-4c63-426d-a1e5-ddf274a205c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fff1220>]}
[0m21:53:18.317812 [info ] [MainThread]: Found 2 models, 494 macros
[0m21:53:18.317950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eaff0c8-4c63-426d-a1e5-ddf274a205c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fca9630>]}
[0m21:53:18.318597 [info ] [MainThread]: 
[0m21:53:18.318729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:53:18.318832 [info ] [MainThread]: 
[0m21:53:18.319019 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:53:18.320717 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m21:53:18.320880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:19.240962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eaff0c8-4c63-426d-a1e5-ddf274a205c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140238870>]}
[0m21:53:19.242229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:19.249193 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m21:53:19.249836 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m21:53:19.250680 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m21:53:19.252121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m21:53:19.252779 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m21:53:19.253302 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m21:53:19.263120 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m21:53:19.264760 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m21:53:19.265363 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m21:53:19.265685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:19.265961 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m21:53:19.266689 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m21:53:19.266894 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:53:19.267387 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m21:53:19.267941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:19.268129 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m21:53:19.268293 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m21:53:19.268775 [debug] [MainThread]: Command end result
[0m21:53:19.281603 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:53:19.282655 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:53:19.286212 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m21:53:19.288790 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2276337, "process_in_blocks": "0", "process_kernel_time": 0.274736, "process_mem_max_rss": "367411200", "process_out_blocks": "0", "process_user_time": 1.432344}
[0m21:53:19.289031 [debug] [MainThread]: Command `dbt compile` succeeded at 21:53:19.288985 after 2.23 seconds
[0m21:53:19.289204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140224890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140224940>]}
[0m21:53:19.289361 [debug] [MainThread]: Flushing usage events
[0m21:53:19.878806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:24.181419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f7c50>]}


============================== 21:54:24.183560 | 095df583-8ac5-45f9-a61a-91b875de29a9 ==============================
[0m21:54:24.183560 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:54:24.183814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:54:25.197617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682f6f0>]}
[0m21:54:25.218415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11965f130>]}
[0m21:54:25.218676 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:54:25.307828 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:54:25.356460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:25.356647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:25.366774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196e5c50>]}
[0m21:54:25.389446 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:54:25.391065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:54:25.400030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196efa70>]}
[0m21:54:25.400230 [info ] [MainThread]: Found 2 models, 494 macros
[0m21:54:25.400387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197a5550>]}
[0m21:54:25.401331 [info ] [MainThread]: 
[0m21:54:25.401473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:25.401576 [info ] [MainThread]: 
[0m21:54:25.401769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:54:25.403204 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1'
[0m21:54:25.403350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:26.249318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1, now list_ace-amplifier-463712-b1_sales_dataset)
[0m21:54:26.250358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:26.567004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bc3860>]}
[0m21:54:26.568130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:26.573958 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m21:54:26.574522 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m21:54:26.575283 [info ] [Thread-1 (]: 1 of 2 START sql view model sales_dataset.sales_final .......................... [RUN]
[0m21:54:26.576012 [info ] [Thread-2 (]: 2 of 2 START sql view model sales_dataset.stage_sales .......................... [RUN]
[0m21:54:26.576637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m21:54:26.577326 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m21:54:26.577994 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m21:54:26.578431 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m21:54:26.586363 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m21:54:26.589079 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m21:54:26.590146 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m21:54:26.590425 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m21:54:26.612946 [debug] [Thread-2 (]: Writing runtime sql for node "model.sales_analytics.stage_sales"
[0m21:54:26.614112 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_analytics.sales_final"
[0m21:54:26.614824 [debug] [Thread-2 (]: On model.sales_analytics.stage_sales: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.stage_sales"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`stage_sales`
  OPTIONS()
  as 

SELECT
    order_id,
    order_date,
  


SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales';


[0m21:54:26.615066 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:26.615808 [debug] [Thread-1 (]: On model.sales_analytics.sales_final: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.sales_final"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`sales_final`
  OPTIONS()
  as SELECT
  country,
  product_name,
  COUNT(order_id) AS total_orders,
  SUM(amount) AS total_revenue,
  CASE
    WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH) THEN 'recent'
    ELSE 'historical'
  END AS partition_group
FROM `local-pointer-452713-p9.sales_dataset.stg_sales`
GROUP BY country, product_name, partition_group;


[0m21:54:26.616098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:26.964138 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:d8a82602-7616-4d07-997a-8b86d0296bab&page=queryresults
[0m21:54:26.964660 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:d8a82602-7616-4d07-997a-8b86d0296bab&page=queryresults
[0m21:54:26.974832 [debug] [Thread-2 (]: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Expected end of input but got keyword SELECT at [14:1]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m21:54:26.976391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cf0410>]}
[0m21:54:26.976776 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model sales_dataset.stage_sales ................. [[31mERROR[0m in 0.40s]
[0m21:54:26.977147 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m21:54:26.977475 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.stage_sales' to be skipped because of status 'error'.  Reason: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Expected end of input but got keyword SELECT at [14:1]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql.
[0m21:54:27.453886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:3067a292-3d6f-4290-8b53-690df4c9b2de&page=queryresults
[0m21:54:27.455208 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:3067a292-3d6f-4290-8b53-690df4c9b2de&page=queryresults
[0m21:54:27.463595 [debug] [Thread-1 (]: Database Error in model sales_final (models/example/Mart/sales_final.sql)
  Access Denied: Table local-pointer-452713-p9:sales_dataset.stg_sales: User does not have permission to query table local-pointer-452713-p9:sales_dataset.stg_sales, or perhaps it does not exist.
  compiled code at target/run/sales_analytics/models/example/Mart/sales_final.sql
[0m21:54:27.464525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095df583-8ac5-45f9-a61a-91b875de29a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c78ec0>]}
[0m21:54:27.465436 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model sales_dataset.sales_final ................. [[31mERROR[0m in 0.89s]
[0m21:54:27.466136 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m21:54:27.466769 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.sales_final' to be skipped because of status 'error'.  Reason: Database Error in model sales_final (models/example/Mart/sales_final.sql)
  Access Denied: Table local-pointer-452713-p9:sales_dataset.stg_sales: User does not have permission to query table local-pointer-452713-p9:sales_dataset.stg_sales, or perhaps it does not exist.
  compiled code at target/run/sales_analytics/models/example/Mart/sales_final.sql.
[0m21:54:27.469072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:27.469811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:27.470016 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m21:54:27.470142 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m21:54:27.470340 [info ] [MainThread]: 
[0m21:54:27.470503 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m21:54:27.471348 [debug] [MainThread]: Command end result
[0m21:54:27.486112 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m21:54:27.487438 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m21:54:27.490980 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m21:54:27.491132 [info ] [MainThread]: 
[0m21:54:27.491304 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:54:27.491441 [info ] [MainThread]: 
[0m21:54:27.491618 [error] [MainThread]: [31mFailure in model stage_sales (models/staging/stage_sales.sql)[0m
[0m21:54:27.491776 [error] [MainThread]:   Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Expected end of input but got keyword SELECT at [14:1]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m21:54:27.491894 [info ] [MainThread]: 
[0m21:54:27.492044 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/staging/stage_sales.sql
[0m21:54:27.492192 [info ] [MainThread]: 
[0m21:54:27.492375 [error] [MainThread]: [31mFailure in model sales_final (models/example/Mart/sales_final.sql)[0m
[0m21:54:27.492563 [error] [MainThread]:   Database Error in model sales_final (models/example/Mart/sales_final.sql)
  Access Denied: Table local-pointer-452713-p9:sales_dataset.stg_sales: User does not have permission to query table local-pointer-452713-p9:sales_dataset.stg_sales, or perhaps it does not exist.
  compiled code at target/run/sales_analytics/models/example/Mart/sales_final.sql
[0m21:54:27.492710 [info ] [MainThread]: 
[0m21:54:27.492885 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/example/Mart/sales_final.sql
[0m21:54:27.493026 [info ] [MainThread]: 
[0m21:54:27.493196 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m21:54:27.496196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.340408, "process_in_blocks": "0", "process_kernel_time": 0.281178, "process_mem_max_rss": "370196480", "process_out_blocks": "0", "process_user_time": 1.486022}
[0m21:54:27.496459 [debug] [MainThread]: Command `dbt run` failed at 21:54:27.496414 after 3.34 seconds
[0m21:54:27.496656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c600f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cee3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f6e50>]}
[0m21:54:27.496836 [debug] [MainThread]: Flushing usage events
[0m21:54:28.201772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:28.094167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107743380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bffc50>]}


============================== 22:02:28.097799 | 7d0cb778-89d7-4200-8bcc-a6ff74f00ab9 ==============================
[0m22:02:28.097799 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:02:28.098062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:29.418832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3b6f0>]}
[0m22:02:29.440421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c35f130>]}
[0m22:02:29.440743 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:02:29.532921 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:02:29.583975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:29.584159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:29.594064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c3e5c50>]}
[0m22:02:29.617232 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:02:29.620048 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:02:29.630315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c3f3a70>]}
[0m22:02:29.630508 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:02:29.630639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c5a5550>]}
[0m22:02:29.631626 [info ] [MainThread]: 
[0m22:02:29.631783 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:29.631890 [info ] [MainThread]: 
[0m22:02:29.632087 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:29.633508 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1'
[0m22:02:29.633664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:30.760933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1, now list_ace-amplifier-463712-b1_sales_dataset)
[0m22:02:30.763485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:31.115207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cac3860>]}
[0m22:02:31.116217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:31.121702 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m22:02:31.122237 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m22:02:31.122892 [info ] [Thread-1 (]: 1 of 2 START sql view model sales_dataset.sales_final .......................... [RUN]
[0m22:02:31.123544 [info ] [Thread-2 (]: 2 of 2 START sql view model sales_dataset.stage_sales .......................... [RUN]
[0m22:02:31.124175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m22:02:31.124776 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m22:02:31.125191 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m22:02:31.125536 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:02:31.135979 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:02:31.137549 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m22:02:31.138323 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m22:02:31.155386 [debug] [Thread-2 (]: Writing runtime sql for node "model.sales_analytics.stage_sales"
[0m22:02:31.155769 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m22:02:31.157011 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_analytics.sales_final"
[0m22:02:31.157299 [debug] [Thread-2 (]: On model.sales_analytics.stage_sales: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.stage_sales"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`stage_sales`
  OPTIONS()
  as 

SELECT
    order_id,
    order_date,
  


SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales';


[0m22:02:31.157535 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:02:31.158102 [debug] [Thread-1 (]: On model.sales_analytics.sales_final: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.sales_final"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`sales_final`
  OPTIONS()
  as SELECT
  country,
  product_name,
  COUNT(order_id) AS total_orders,
  SUM(amount) AS total_revenue,
  CASE
    WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH) THEN 'recent'
    ELSE 'historical'
  END AS partition_group
FROM `local-pointer-452713-p9.sales_dataset.stg_sales`
GROUP BY country, product_name, partition_group;


[0m22:02:31.158497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:31.512687 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:8d2c6660-a1b7-4a50-aebc-061bab64a2ee&page=queryresults
[0m22:02:31.513949 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:8d2c6660-a1b7-4a50-aebc-061bab64a2ee&page=queryresults
[0m22:02:31.530272 [debug] [Thread-2 (]: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Expected end of input but got keyword SELECT at [14:1]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:02:31.532860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cbfc710>]}
[0m22:02:31.533319 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model sales_dataset.stage_sales ................. [[31mERROR[0m in 0.41s]
[0m22:02:31.533723 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m22:02:31.534147 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.stage_sales' to be skipped because of status 'error'.  Reason: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Expected end of input but got keyword SELECT at [14:1]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql.
[0m22:02:31.921376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:a841eba8-c293-4cb5-82e5-a9878860f171&page=queryresults
[0m22:02:31.922736 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:a841eba8-c293-4cb5-82e5-a9878860f171&page=queryresults
[0m22:02:31.931709 [debug] [Thread-1 (]: Database Error in model sales_final (models/example/Mart/sales_final.sql)
  Access Denied: Table local-pointer-452713-p9:sales_dataset.stg_sales: User does not have permission to query table local-pointer-452713-p9:sales_dataset.stg_sales, or perhaps it does not exist.
  compiled code at target/run/sales_analytics/models/example/Mart/sales_final.sql
[0m22:02:31.932656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0cb778-89d7-4200-8bcc-a6ff74f00ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cb78f70>]}
[0m22:02:31.933554 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model sales_dataset.sales_final ................. [[31mERROR[0m in 0.81s]
[0m22:02:31.934250 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m22:02:31.934911 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.sales_final' to be skipped because of status 'error'.  Reason: Database Error in model sales_final (models/example/Mart/sales_final.sql)
  Access Denied: Table local-pointer-452713-p9:sales_dataset.stg_sales: User does not have permission to query table local-pointer-452713-p9:sales_dataset.stg_sales, or perhaps it does not exist.
  compiled code at target/run/sales_analytics/models/example/Mart/sales_final.sql.
[0m22:02:31.937344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:31.937950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:31.938104 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m22:02:31.938227 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:02:31.938462 [info ] [MainThread]: 
[0m22:02:31.938618 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m22:02:31.939074 [debug] [MainThread]: Command end result
[0m22:02:31.955350 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:02:31.956746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:02:31.960292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:02:31.960522 [info ] [MainThread]: 
[0m22:02:31.960745 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:02:31.961036 [info ] [MainThread]: 
[0m22:02:31.961346 [error] [MainThread]: [31mFailure in model stage_sales (models/staging/stage_sales.sql)[0m
[0m22:02:31.961723 [error] [MainThread]:   Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Expected end of input but got keyword SELECT at [14:1]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:02:31.961853 [info ] [MainThread]: 
[0m22:02:31.961996 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/staging/stage_sales.sql
[0m22:02:31.962114 [info ] [MainThread]: 
[0m22:02:31.962273 [error] [MainThread]: [31mFailure in model sales_final (models/example/Mart/sales_final.sql)[0m
[0m22:02:31.962418 [error] [MainThread]:   Database Error in model sales_final (models/example/Mart/sales_final.sql)
  Access Denied: Table local-pointer-452713-p9:sales_dataset.stg_sales: User does not have permission to query table local-pointer-452713-p9:sales_dataset.stg_sales, or perhaps it does not exist.
  compiled code at target/run/sales_analytics/models/example/Mart/sales_final.sql
[0m22:02:31.962546 [info ] [MainThread]: 
[0m22:02:31.962707 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/example/Mart/sales_final.sql
[0m22:02:31.962851 [info ] [MainThread]: 
[0m22:02:31.963023 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m22:02:31.965921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9019382, "process_in_blocks": "0", "process_kernel_time": 0.347411, "process_mem_max_rss": "369508352", "process_out_blocks": "0", "process_user_time": 1.511906}
[0m22:02:31.966239 [debug] [MainThread]: Command `dbt run` failed at 22:02:31.966181 after 3.90 seconds
[0m22:02:31.966484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cb63cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cc003b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f191d0>]}
[0m22:02:31.966689 [debug] [MainThread]: Flushing usage events
[0m22:02:32.647110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:40.522025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ebc50>]}


============================== 22:05:40.524966 | 47a219fa-9347-451a-a5f1-162cef265d5f ==============================
[0m22:05:40.524966 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:05:40.525223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --select stage_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.857865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47a219fa-9347-451a-a5f1-162cef265d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082276f0>]}
[0m22:05:41.879299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47a219fa-9347-451a-a5f1-162cef265d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14335f130>]}
[0m22:05:41.879623 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:05:41.970563 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:05:42.021781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:42.021976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:42.032160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47a219fa-9347-451a-a5f1-162cef265d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433e5d50>]}
[0m22:05:42.054866 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:05:42.055930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:05:42.065563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47a219fa-9347-451a-a5f1-162cef265d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1437f5220>]}
[0m22:05:42.065771 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:05:42.065902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47a219fa-9347-451a-a5f1-162cef265d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434a9630>]}
[0m22:05:42.066505 [info ] [MainThread]: 
[0m22:05:42.066659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:42.066765 [info ] [MainThread]: 
[0m22:05:42.066981 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:05:42.068646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m22:05:42.068772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.350765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47a219fa-9347-451a-a5f1-162cef265d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a3c870>]}
[0m22:05:43.351917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.358331 [debug] [Thread-1 (]: Began running node model.sales_analytics.stage_sales
[0m22:05:43.359087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.stage_sales)
[0m22:05:43.359603 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:05:43.370024 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:05:43.370746 [debug] [Thread-1 (]: Began executing node model.sales_analytics.stage_sales
[0m22:05:43.370984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:43.371493 [debug] [Thread-1 (]: Finished running node model.sales_analytics.stage_sales
[0m22:05:43.372403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:43.372725 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:05:43.373151 [debug] [MainThread]: Command end result
[0m22:05:43.386297 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:05:43.387243 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:05:43.390961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:05:43.391206 [info ] [MainThread]: Compiled node 'stage_sales' is:


SELECT
    order_id,
    order_date,
  


SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales'
[0m22:05:43.393858 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.9007578, "process_in_blocks": "0", "process_kernel_time": 0.332057, "process_mem_max_rss": "369983488", "process_out_blocks": "0", "process_user_time": 1.428325}
[0m22:05:43.394136 [debug] [MainThread]: Command `dbt compile` succeeded at 22:05:43.394086 after 2.90 seconds
[0m22:05:43.394330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a287e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a28940>]}
[0m22:05:43.394482 [debug] [MainThread]: Flushing usage events
[0m22:05:44.097859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:56.974586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ebc50>]}


============================== 22:06:56.977421 | 966c77d4-3151-4985-b4ad-cfe9c7fa9387 ==============================
[0m22:06:56.977421 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:06:56.977686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile --select stage_sales', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:58.319152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '966c77d4-3151-4985-b4ad-cfe9c7fa9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066236f0>]}
[0m22:06:58.341310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '966c77d4-3151-4985-b4ad-cfe9c7fa9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14155f130>]}
[0m22:06:58.341706 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:06:58.434721 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:06:58.484999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:06:58.485198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:06:58.495040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '966c77d4-3151-4985-b4ad-cfe9c7fa9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1415e5d50>]}
[0m22:06:58.517291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:06:58.518324 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:06:58.527332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '966c77d4-3151-4985-b4ad-cfe9c7fa9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142af5220>]}
[0m22:06:58.527522 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:06:58.527654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '966c77d4-3151-4985-b4ad-cfe9c7fa9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416a9630>]}
[0m22:06:58.528216 [info ] [MainThread]: 
[0m22:06:58.528375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:58.528501 [info ] [MainThread]: 
[0m22:06:58.528743 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:58.530477 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m22:06:58.530623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:59.470173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '966c77d4-3151-4985-b4ad-cfe9c7fa9387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c38870>]}
[0m22:06:59.471360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:59.476896 [debug] [Thread-1 (]: Began running node model.sales_analytics.stage_sales
[0m22:06:59.477762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.stage_sales)
[0m22:06:59.478305 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:06:59.488842 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:06:59.489760 [debug] [Thread-1 (]: Began executing node model.sales_analytics.stage_sales
[0m22:06:59.490140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:59.490786 [debug] [Thread-1 (]: Finished running node model.sales_analytics.stage_sales
[0m22:06:59.491528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:59.491727 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:06:59.492235 [debug] [MainThread]: Command end result
[0m22:06:59.505731 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:06:59.506922 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:06:59.510521 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:06:59.510740 [info ] [MainThread]: Compiled node 'stage_sales' is:


SELECT
    order_id,
    order_date,
  


SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales'
[0m22:06:59.513459 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.5674028, "process_in_blocks": "0", "process_kernel_time": 0.335616, "process_mem_max_rss": "368607232", "process_out_blocks": "0", "process_user_time": 1.430296}
[0m22:06:59.513709 [debug] [MainThread]: Command `dbt compile` succeeded at 22:06:59.513658 after 2.57 seconds
[0m22:06:59.513915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c287e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c28940>]}
[0m22:06:59.514098 [debug] [MainThread]: Flushing usage events
[0m22:07:00.480004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:54.463696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106febd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106febc50>]}


============================== 22:08:54.466611 | 31a5472b-bb1f-4f7b-b5f9-328adf5c87b2 ==============================
[0m22:08:54.466611 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:08:54.466875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:55.775179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31a5472b-bb1f-4f7b-b5f9-328adf5c87b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060276f0>]}
[0m22:08:55.796494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31a5472b-bb1f-4f7b-b5f9-328adf5c87b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a5f130>]}
[0m22:08:55.796778 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:08:55.886202 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:08:55.918605 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbt_projcet.yml is invalid because the value of 'models' is not a list
[0m22:08:55.920783 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.4836929, "process_in_blocks": "0", "process_kernel_time": 0.302391, "process_mem_max_rss": "366133248", "process_out_blocks": "0", "process_user_time": 1.35521}
[0m22:08:55.921150 [debug] [MainThread]: Command `dbt compile` failed at 22:08:55.921105 after 1.48 seconds
[0m22:08:55.921322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151ae5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1521e0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520f9040>]}
[0m22:08:55.921463 [debug] [MainThread]: Flushing usage events
[0m22:08:56.736588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:25.100801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d3c50>]}


============================== 22:09:25.103568 | df0470f0-120d-4e50-b9fa-91f7d771cb32 ==============================
[0m22:09:25.103568 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:09:25.103824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt compile --select stage_sales', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:26.196746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df0470f0-120d-4e50-b9fa-91f7d771cb32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660b6f0>]}
[0m22:09:26.217752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df0470f0-120d-4e50-b9fa-91f7d771cb32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11945f130>]}
[0m22:09:26.218020 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:09:26.306073 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:09:26.337430 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbt_projcet.yml is invalid because the value of 'models' is not a list
[0m22:09:26.339872 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.2659583, "process_in_blocks": "0", "process_kernel_time": 0.24863, "process_mem_max_rss": "364658688", "process_out_blocks": "0", "process_user_time": 1.319646}
[0m22:09:26.340193 [debug] [MainThread]: Command `dbt compile` failed at 22:09:26.340150 after 1.27 seconds
[0m22:09:26.340352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194e5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199e4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198f5040>]}
[0m22:09:26.340489 [debug] [MainThread]: Flushing usage events
[0m22:09:26.925263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:54.553989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885fc50>]}


============================== 22:09:54.556304 | 506164ae-f32b-4711-8da6-35fcb4f2fea2 ==============================
[0m22:09:54.556304 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:09:54.556560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:55.526751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '506164ae-f32b-4711-8da6-35fcb4f2fea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9b6f0>]}
[0m22:09:55.547309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '506164ae-f32b-4711-8da6-35fcb4f2fea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a95f130>]}
[0m22:09:55.547575 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:09:55.637784 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:09:55.687046 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m22:09:55.687349 [debug] [MainThread]: Partial parsing: updated file: sales_analytics://models/example/Mart/sales_final.sql
[0m22:09:55.687498 [debug] [MainThread]: Partial parsing: updated file: sales_analytics://models/staging/stage_sales.sql
[0m22:09:55.776175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '506164ae-f32b-4711-8da6-35fcb4f2fea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9e6450>]}
[0m22:09:55.799719 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:09:55.801114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:09:55.809703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '506164ae-f32b-4711-8da6-35fcb4f2fea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adf3b60>]}
[0m22:09:55.809888 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:09:55.810018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '506164ae-f32b-4711-8da6-35fcb4f2fea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa4b150>]}
[0m22:09:55.810679 [info ] [MainThread]: 
[0m22:09:55.810816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:09:55.810917 [info ] [MainThread]: 
[0m22:09:55.811143 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:09:55.812994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m22:09:55.813132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:56.939536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '506164ae-f32b-4711-8da6-35fcb4f2fea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af2bd40>]}
[0m22:09:56.940691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:56.946347 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m22:09:56.946878 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m22:09:56.947533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m22:09:56.948121 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m22:09:56.948554 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m22:09:56.948929 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:09:56.955737 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m22:09:56.957703 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:09:56.958428 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m22:09:56.958664 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m22:09:56.958914 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:09:56.959222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:56.959944 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m22:09:56.960434 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m22:09:56.961213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:56.961369 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m22:09:56.961543 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:09:56.962138 [debug] [MainThread]: Command end result
[0m22:09:56.975201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:09:56.976417 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:09:56.980280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:09:56.983016 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.4537644, "process_in_blocks": "0", "process_kernel_time": 0.273651, "process_mem_max_rss": "372228096", "process_out_blocks": "0", "process_user_time": 1.497105}
[0m22:09:56.983294 [debug] [MainThread]: Command `dbt compile` succeeded at 22:09:56.983243 after 2.45 seconds
[0m22:09:56.983483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108840ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b069650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0695a0>]}
[0m22:09:56.983649 [debug] [MainThread]: Flushing usage events
[0m22:09:57.567240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:10:14.772315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cbc50>]}


============================== 22:10:14.774556 | 85848a66-ac64-47e4-abaa-a09863123d72 ==============================
[0m22:10:14.774556 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:10:14.774849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:10:15.720124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087076f0>]}
[0m22:10:15.741295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b45f130>]}
[0m22:10:15.741565 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:10:15.831460 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:10:15.879555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:10:15.879723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:10:15.889587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4e5c50>]}
[0m22:10:15.912372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:10:15.913390 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:10:15.922462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4f3a70>]}
[0m22:10:15.922669 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:10:15.922809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5a5550>]}
[0m22:10:15.923779 [info ] [MainThread]: 
[0m22:10:15.923920 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:15.924023 [info ] [MainThread]: 
[0m22:10:15.924221 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:10:15.925781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1'
[0m22:10:15.925951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:16.800197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1, now list_ace-amplifier-463712-b1_sales_dataset)
[0m22:10:16.801251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:17.110938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9cf860>]}
[0m22:10:17.112252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:17.118691 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m22:10:17.119220 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m22:10:17.120137 [info ] [Thread-1 (]: 1 of 2 START sql view model sales_dataset.sales_final .......................... [RUN]
[0m22:10:17.120841 [info ] [Thread-2 (]: 2 of 2 START sql view model sales_dataset.stage_sales .......................... [RUN]
[0m22:10:17.121453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m22:10:17.122253 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m22:10:17.122695 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m22:10:17.123081 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:10:17.132508 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m22:10:17.133907 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:10:17.134505 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m22:10:17.134708 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m22:10:17.152781 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_analytics.sales_final"
[0m22:10:17.153385 [debug] [Thread-2 (]: Writing runtime sql for node "model.sales_analytics.stage_sales"
[0m22:10:17.153916 [debug] [Thread-1 (]: On model.sales_analytics.sales_final: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.sales_final"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`sales_final`
  OPTIONS()
  as SELECT
  country,
  product_name,
  COUNT(order_id) AS total_orders,
  SUM(amount) AS total_revenue,
  
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM `ace-amplifier-463712-b1.sales_dataset.raw_sales`
GROUP BY country, product_name, partition_group;


[0m22:10:17.154172 [debug] [Thread-2 (]: On model.sales_analytics.stage_sales: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.stage_sales"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`stage_sales`
  OPTIONS()
  as 
SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales';


[0m22:10:17.154412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:17.154609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:10:17.500552 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:2839ce6c-7118-4053-996e-694cc3d3b385&page=queryresults
[0m22:10:17.501163 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:2839ce6c-7118-4053-996e-694cc3d3b385&page=queryresults
[0m22:10:17.514021 [debug] [Thread-2 (]: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:10:17.517641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11baf0710>]}
[0m22:10:17.518528 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model sales_dataset.stage_sales ................. [[31mERROR[0m in 0.39s]
[0m22:10:17.518851 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m22:10:17.519211 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.stage_sales' to be skipped because of status 'error'.  Reason: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql.
[0m22:10:17.783217 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:c7dfdebf-a5d2-471a-9386-0457b3786dba&page=queryresults
[0m22:10:18.190717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85848a66-ac64-47e4-abaa-a09863123d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba78ec0>]}
[0m22:10:18.191090 [info ] [Thread-1 (]: 1 of 2 OK created sql view model sales_dataset.sales_final ..................... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m22:10:18.191382 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m22:10:18.192061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:18.192388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:18.192530 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m22:10:18.192635 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:10:18.192784 [info ] [MainThread]: 
[0m22:10:18.192919 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m22:10:18.193269 [debug] [MainThread]: Command end result
[0m22:10:18.206290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:10:18.207289 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:10:18.210046 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:10:18.210179 [info ] [MainThread]: 
[0m22:10:18.210328 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:10:18.210450 [info ] [MainThread]: 
[0m22:10:18.210607 [error] [MainThread]: [31mFailure in model stage_sales (models/staging/stage_sales.sql)[0m
[0m22:10:18.210753 [error] [MainThread]:   Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:10:18.210864 [info ] [MainThread]: 
[0m22:10:18.210991 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/staging/stage_sales.sql
[0m22:10:18.211099 [info ] [MainThread]: 
[0m22:10:18.211333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m22:10:18.214214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.467101, "process_in_blocks": "0", "process_kernel_time": 0.30228, "process_mem_max_rss": "373899264", "process_out_blocks": "0", "process_user_time": 1.508473}
[0m22:10:18.214948 [debug] [MainThread]: Command `dbt run` failed at 22:10:18.214855 after 3.47 seconds
[0m22:10:18.215197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba75810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11baec0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e51d0>]}
[0m22:10:18.215403 [debug] [MainThread]: Flushing usage events
[0m22:10:19.029269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:14:21.126383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120eebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120eebc50>]}


============================== 22:14:21.130322 | 93ed51ec-8341-45bf-ac1d-5375190ad319 ==============================
[0m22:14:21.130322 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:14:21.130595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stage_sales', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:22.500965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ed51ec-8341-45bf-ac1d-5375190ad319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e236f0>]}
[0m22:14:22.522236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93ed51ec-8341-45bf-ac1d-5375190ad319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14155f130>]}
[0m22:14:22.522497 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:14:22.610733 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:14:22.661622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:14:22.661803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:14:22.671790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93ed51ec-8341-45bf-ac1d-5375190ad319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1415e5c50>]}
[0m22:14:22.694662 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:14:22.697476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:14:22.707278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93ed51ec-8341-45bf-ac1d-5375190ad319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1415f3a70>]}
[0m22:14:22.707454 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:14:22.707580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ed51ec-8341-45bf-ac1d-5375190ad319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416a5550>]}
[0m22:14:22.708413 [info ] [MainThread]: 
[0m22:14:22.708569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:22.708675 [info ] [MainThread]: 
[0m22:14:22.708866 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:14:22.709208 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1'
[0m22:14:22.709352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:23.627173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1, now list_ace-amplifier-463712-b1_sales_dataset)
[0m22:14:23.628168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:23.987122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ed51ec-8341-45bf-ac1d-5375190ad319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141ccf860>]}
[0m22:14:23.988576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:23.994943 [debug] [Thread-1 (]: Began running node model.sales_analytics.stage_sales
[0m22:14:23.995733 [info ] [Thread-1 (]: 1 of 1 START sql view model sales_dataset.stage_sales .......................... [RUN]
[0m22:14:23.997178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.stage_sales)
[0m22:14:23.997736 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:14:24.008229 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:14:24.009597 [debug] [Thread-1 (]: Began executing node model.sales_analytics.stage_sales
[0m22:14:24.026699 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_analytics.stage_sales"
[0m22:14:24.027550 [debug] [Thread-1 (]: On model.sales_analytics.stage_sales: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.stage_sales"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`stage_sales`
  OPTIONS()
  as 
SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales';


[0m22:14:24.027826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:24.354604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:433d5390-3dde-41f9-bf2d-b735e173b1e4&page=queryresults
[0m22:14:24.354964 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:433d5390-3dde-41f9-bf2d-b735e173b1e4&page=queryresults
[0m22:14:24.364148 [debug] [Thread-1 (]: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:14:24.365490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ed51ec-8341-45bf-ac1d-5375190ad319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141c2fe90>]}
[0m22:14:24.365888 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model sales_dataset.stage_sales ................. [[31mERROR[0m in 0.37s]
[0m22:14:24.366162 [debug] [Thread-1 (]: Finished running node model.sales_analytics.stage_sales
[0m22:14:24.366425 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.stage_sales' to be skipped because of status 'error'.  Reason: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql.
[0m22:14:24.367435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:24.367707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:24.367827 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:14:24.367952 [info ] [MainThread]: 
[0m22:14:24.368081 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m22:14:24.368361 [debug] [MainThread]: Command end result
[0m22:14:24.378446 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:14:24.379404 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:14:24.382984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:14:24.383176 [info ] [MainThread]: 
[0m22:14:24.383335 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:14:24.383455 [info ] [MainThread]: 
[0m22:14:24.383599 [error] [MainThread]: [31mFailure in model stage_sales (models/staging/stage_sales.sql)[0m
[0m22:14:24.383741 [error] [MainThread]:   Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:14:24.383847 [info ] [MainThread]: 
[0m22:14:24.383966 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/staging/stage_sales.sql
[0m22:14:24.384067 [info ] [MainThread]: 
[0m22:14:24.384194 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:14:24.387464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.29005, "process_in_blocks": "0", "process_kernel_time": 0.341024, "process_mem_max_rss": "370327552", "process_out_blocks": "0", "process_user_time": 1.468162}
[0m22:14:24.387697 [debug] [MainThread]: Command `dbt run` failed at 22:14:24.387658 after 3.29 seconds
[0m22:14:24.387898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141d79650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141d75950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141d753b0>]}
[0m22:14:24.388076 [debug] [MainThread]: Flushing usage events
[0m22:14:25.088044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:20.213322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723bc50>]}


============================== 22:15:20.215953 | f2643a03-0238-481e-af3b-f6e9da6a6c8d ==============================
[0m22:15:20.215953 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:15:20.216199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stage_sales', 'send_anonymous_usage_stats': 'True'}
[0m22:15:21.392599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2643a03-0238-481e-af3b-f6e9da6a6c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065776f0>]}
[0m22:15:21.413808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2643a03-0238-481e-af3b-f6e9da6a6c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13945f130>]}
[0m22:15:21.414052 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:15:21.507568 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:15:21.557759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:21.557945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:21.567821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2643a03-0238-481e-af3b-f6e9da6a6c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1394e5c50>]}
[0m22:15:21.590285 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:15:21.591807 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:15:21.601350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2643a03-0238-481e-af3b-f6e9da6a6c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1394f3a70>]}
[0m22:15:21.601548 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:15:21.601676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2643a03-0238-481e-af3b-f6e9da6a6c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395a51d0>]}
[0m22:15:21.602500 [info ] [MainThread]: 
[0m22:15:21.602634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:21.602734 [info ] [MainThread]: 
[0m22:15:21.602923 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:15:21.603261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1'
[0m22:15:21.603420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:22.490049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1, now list_ace-amplifier-463712-b1_sales_dataset)
[0m22:15:22.491052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:22.832594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2643a03-0238-481e-af3b-f6e9da6a6c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139ac3860>]}
[0m22:15:22.833709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:22.841408 [debug] [Thread-1 (]: Began running node model.sales_analytics.stage_sales
[0m22:15:22.842688 [info ] [Thread-1 (]: 1 of 1 START sql view model sales_dataset.stage_sales .......................... [RUN]
[0m22:15:22.843527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.stage_sales)
[0m22:15:22.844068 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:15:22.854281 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:15:22.855177 [debug] [Thread-1 (]: Began executing node model.sales_analytics.stage_sales
[0m22:15:22.871780 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_analytics.stage_sales"
[0m22:15:22.872321 [debug] [Thread-1 (]: On model.sales_analytics.stage_sales: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.stage_sales"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`stage_sales`
  OPTIONS()
  as 
SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales';


[0m22:15:22.872586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:23.231516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:6e91bf5e-e4a7-4686-bc65-604c2b2379a6&page=queryresults
[0m22:15:23.232764 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:6e91bf5e-e4a7-4686-bc65-604c2b2379a6&page=queryresults
[0m22:15:23.250153 [debug] [Thread-1 (]: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:15:23.252677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2643a03-0238-481e-af3b-f6e9da6a6c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139a6fe90>]}
[0m22:15:23.253072 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model sales_dataset.stage_sales ................. [[31mERROR[0m in 0.41s]
[0m22:15:23.253509 [debug] [Thread-1 (]: Finished running node model.sales_analytics.stage_sales
[0m22:15:23.253939 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.stage_sales' to be skipped because of status 'error'.  Reason: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql.
[0m22:15:23.255239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:23.255512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:23.255640 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:15:23.255772 [info ] [MainThread]: 
[0m22:15:23.255927 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m22:15:23.256400 [debug] [MainThread]: Command end result
[0m22:15:23.268457 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:15:23.269404 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:15:23.271989 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:15:23.272124 [info ] [MainThread]: 
[0m22:15:23.272278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:15:23.272402 [info ] [MainThread]: 
[0m22:15:23.272553 [error] [MainThread]: [31mFailure in model stage_sales (models/staging/stage_sales.sql)[0m
[0m22:15:23.272698 [error] [MainThread]:   Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:15:23.272812 [info ] [MainThread]: 
[0m22:15:23.272938 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/staging/stage_sales.sql
[0m22:15:23.273045 [info ] [MainThread]: 
[0m22:15:23.273168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:15:23.275547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.08896, "process_in_blocks": "0", "process_kernel_time": 0.306515, "process_mem_max_rss": "370229248", "process_out_blocks": "0", "process_user_time": 1.484541}
[0m22:15:23.275808 [debug] [MainThread]: Command `dbt run` failed at 22:15:23.275758 after 3.09 seconds
[0m22:15:23.276026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b79650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b75950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b753b0>]}
[0m22:15:23.276183 [debug] [MainThread]: Flushing usage events
[0m22:15:23.861531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:24.624736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37c50>]}


============================== 22:16:24.627611 | 4647a40e-a8a6-47f1-92f3-7248286b87d4 ==============================
[0m22:16:24.627611 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:16:24.627871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stage_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:16:25.906492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4647a40e-a8a6-47f1-92f3-7248286b87d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041736f0>]}
[0m22:16:25.927666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4647a40e-a8a6-47f1-92f3-7248286b87d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e5f130>]}
[0m22:16:25.927932 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:16:26.016441 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:16:26.064883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:26.065081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:26.075053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4647a40e-a8a6-47f1-92f3-7248286b87d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ee5c50>]}
[0m22:16:26.097316 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:16:26.098335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:16:26.106907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4647a40e-a8a6-47f1-92f3-7248286b87d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ef3a70>]}
[0m22:16:26.107081 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:16:26.107212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4647a40e-a8a6-47f1-92f3-7248286b87d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fa5550>]}
[0m22:16:26.108012 [info ] [MainThread]: 
[0m22:16:26.108148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:26.108248 [info ] [MainThread]: 
[0m22:16:26.108432 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:16:26.108773 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1'
[0m22:16:26.108904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:27.244064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1, now list_ace-amplifier-463712-b1_sales_dataset)
[0m22:16:27.245054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:27.650263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4647a40e-a8a6-47f1-92f3-7248286b87d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1173cf860>]}
[0m22:16:27.651123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:27.654980 [debug] [Thread-1 (]: Began running node model.sales_analytics.stage_sales
[0m22:16:27.655798 [info ] [Thread-1 (]: 1 of 1 START sql view model sales_dataset.stage_sales .......................... [RUN]
[0m22:16:27.656466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.stage_sales)
[0m22:16:27.657031 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:16:27.666046 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:16:27.666608 [debug] [Thread-1 (]: Began executing node model.sales_analytics.stage_sales
[0m22:16:27.684160 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_analytics.stage_sales"
[0m22:16:27.684728 [debug] [Thread-1 (]: On model.sales_analytics.stage_sales: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.stage_sales"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`stage_sales`
  OPTIONS()
  as 
SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM 'ace-amplifier-463712-b1.sales_dataset.raw_sales';


[0m22:16:27.684961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:28.075123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:ea63d553-72ff-4201-a329-ea54f107e311&page=queryresults
[0m22:16:28.076501 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:ea63d553-72ff-4201-a329-ea54f107e311&page=queryresults
[0m22:16:28.093243 [debug] [Thread-1 (]: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:16:28.095194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4647a40e-a8a6-47f1-92f3-7248286b87d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11732fe90>]}
[0m22:16:28.095659 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model sales_dataset.stage_sales ................. [[31mERROR[0m in 0.44s]
[0m22:16:28.095950 [debug] [Thread-1 (]: Finished running node model.sales_analytics.stage_sales
[0m22:16:28.096349 [debug] [Thread-7 (]: Marking all children of 'model.sales_analytics.stage_sales' to be skipped because of status 'error'.  Reason: Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql.
[0m22:16:28.098171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:16:28.098496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:28.098621 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:16:28.098756 [info ] [MainThread]: 
[0m22:16:28.098934 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m22:16:28.099920 [debug] [MainThread]: Command end result
[0m22:16:28.113464 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:16:28.114555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:16:28.118088 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:16:28.118284 [info ] [MainThread]: 
[0m22:16:28.118492 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:16:28.118652 [info ] [MainThread]: 
[0m22:16:28.118853 [error] [MainThread]: [31mFailure in model stage_sales (models/staging/stage_sales.sql)[0m
[0m22:16:28.119012 [error] [MainThread]:   Database Error in model stage_sales (models/staging/stage_sales.sql)
  Syntax error: Unexpected string literal 'ace-amplifier-463712-b1.sales_dataset.raw_sales' at [20:6]
  compiled code at target/run/sales_analytics/models/staging/stage_sales.sql
[0m22:16:28.119135 [info ] [MainThread]: 
[0m22:16:28.119272 [info ] [MainThread]:   compiled code at target/compiled/sales_analytics/models/staging/stage_sales.sql
[0m22:16:28.119387 [info ] [MainThread]: 
[0m22:16:28.119521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:16:28.122216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5254097, "process_in_blocks": "0", "process_kernel_time": 0.336339, "process_mem_max_rss": "369655808", "process_out_blocks": "0", "process_user_time": 1.480771}
[0m22:16:28.122457 [debug] [MainThread]: Command `dbt run` failed at 22:16:28.122417 after 3.53 seconds
[0m22:16:28.122657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11747d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117479950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174793b0>]}
[0m22:16:28.122853 [debug] [MainThread]: Flushing usage events
[0m22:16:28.801770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:03.658648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ebc50>]}


============================== 22:17:03.660878 | f4be8b79-93d1-4b6f-91fa-2939305e13c7 ==============================
[0m22:17:03.660878 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:17:03.661147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:04.638645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4be8b79-93d1-4b6f-91fa-2939305e13c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103236f0>]}
[0m22:17:04.660143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4be8b79-93d1-4b6f-91fa-2939305e13c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f5f130>]}
[0m22:17:04.660425 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:17:04.754162 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:17:04.802453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:04.802637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:04.812251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4be8b79-93d1-4b6f-91fa-2939305e13c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143fe5d50>]}
[0m22:17:04.834764 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:17:04.835792 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:17:04.844285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4be8b79-93d1-4b6f-91fa-2939305e13c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144bf5220>]}
[0m22:17:04.844480 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:17:04.844616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4be8b79-93d1-4b6f-91fa-2939305e13c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448a9630>]}
[0m22:17:04.845274 [info ] [MainThread]: 
[0m22:17:04.845408 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:04.845509 [info ] [MainThread]: 
[0m22:17:04.845704 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:17:04.847534 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m22:17:04.847699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:05.775955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4be8b79-93d1-4b6f-91fa-2939305e13c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e38870>]}
[0m22:17:05.776909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:05.784013 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m22:17:05.784641 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m22:17:05.785201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m22:17:05.785829 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m22:17:05.786318 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m22:17:05.786699 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:17:05.795946 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m22:17:05.798191 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:17:05.798966 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m22:17:05.799177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:05.799353 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m22:17:05.799840 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m22:17:05.800001 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:17:05.800597 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m22:17:05.801335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:05.801543 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m22:17:05.801699 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:17:05.802016 [debug] [MainThread]: Command end result
[0m22:17:05.814968 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:17:05.816024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:17:05.819340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:17:05.822067 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.188805, "process_in_blocks": "0", "process_kernel_time": 0.272731, "process_mem_max_rss": "368328704", "process_out_blocks": "0", "process_user_time": 1.429938}
[0m22:17:05.822342 [debug] [MainThread]: Command `dbt compile` succeeded at 22:17:05.822291 after 2.19 seconds
[0m22:17:05.822539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e24890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e24940>]}
[0m22:17:05.822724 [debug] [MainThread]: Flushing usage events
[0m22:17:06.406971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:39.776539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728bc50>]}


============================== 22:17:39.778931 | 4cec19c9-0099-4d92-93ec-7b4dbc5b0612 ==============================
[0m22:17:39.778931 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:17:39.779223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:40.690656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cec19c9-0099-4d92-93ec-7b4dbc5b0612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c36f0>]}
[0m22:17:40.712237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cec19c9-0099-4d92-93ec-7b4dbc5b0612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11935f130>]}
[0m22:17:40.712583 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:17:40.804593 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:17:40.854547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:17:40.854839 [debug] [MainThread]: Partial parsing: updated file: sales_analytics://models/staging/stage_sales.sql
[0m22:17:40.942937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cec19c9-0099-4d92-93ec-7b4dbc5b0612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193e5d50>]}
[0m22:17:40.966991 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:17:40.968181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:17:40.977164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cec19c9-0099-4d92-93ec-7b4dbc5b0612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197f16d0>]}
[0m22:17:40.977375 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:17:40.977507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cec19c9-0099-4d92-93ec-7b4dbc5b0612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119449470>]}
[0m22:17:40.978194 [info ] [MainThread]: 
[0m22:17:40.978378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:40.978504 [info ] [MainThread]: 
[0m22:17:40.978699 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:17:40.980708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m22:17:40.980977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:41.843896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cec19c9-0099-4d92-93ec-7b4dbc5b0612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119937520>]}
[0m22:17:41.845093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:41.852890 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m22:17:41.853592 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m22:17:41.854343 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m22:17:41.854825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m22:17:41.855231 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:17:41.855447 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m22:17:41.862187 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:17:41.864111 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m22:17:41.864841 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m22:17:41.865016 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m22:17:41.865188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:41.865340 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:17:41.865770 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m22:17:41.866120 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m22:17:41.866749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:41.866887 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m22:17:41.867071 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:17:41.867613 [debug] [MainThread]: Command end result
[0m22:17:41.880060 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:17:41.881092 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:17:41.884738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:17:41.887511 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1370552, "process_in_blocks": "0", "process_kernel_time": 0.268866, "process_mem_max_rss": "372228096", "process_out_blocks": "0", "process_user_time": 1.521114}
[0m22:17:41.887742 [debug] [MainThread]: Command `dbt compile` succeeded at 22:17:41.887699 after 2.14 seconds
[0m22:17:41.887920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11991d860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11991d5a0>]}
[0m22:17:41.888078 [debug] [MainThread]: Flushing usage events
[0m22:17:42.465267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:58.095458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d7c50>]}


============================== 22:17:58.097865 | 2acc8ac0-d9b7-4852-9a5e-21e8541e9609 ==============================
[0m22:17:58.097865 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:17:58.098115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:58.939092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c136f0>]}
[0m22:17:58.960185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa5f130>]}
[0m22:17:58.960442 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:17:59.044519 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:17:59.083434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:59.083620 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:59.093468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aae5c50>]}
[0m22:17:59.116347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:17:59.117204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:17:59.122854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaf3a70>]}
[0m22:17:59.123038 [info ] [MainThread]: Found 2 models, 494 macros
[0m22:17:59.123169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aba1550>]}
[0m22:17:59.124107 [info ] [MainThread]: 
[0m22:17:59.124247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:59.124344 [info ] [MainThread]: 
[0m22:17:59.124525 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:17:59.126053 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1'
[0m22:17:59.126232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:59.919227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1, now list_ace-amplifier-463712-b1_sales_dataset)
[0m22:17:59.920266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:00.262742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afc3860>]}
[0m22:18:00.264748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:00.270836 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m22:18:00.271437 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m22:18:00.272195 [info ] [Thread-2 (]: 2 of 2 START sql view model sales_dataset.stage_sales .......................... [RUN]
[0m22:18:00.272986 [info ] [Thread-1 (]: 1 of 2 START sql view model sales_dataset.sales_final .......................... [RUN]
[0m22:18:00.273646 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m22:18:00.274130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m22:18:00.274670 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m22:18:00.274904 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m22:18:00.283760 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m22:18:00.285214 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m22:18:00.285770 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m22:18:00.286076 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m22:18:00.307910 [debug] [Thread-2 (]: Writing runtime sql for node "model.sales_analytics.stage_sales"
[0m22:18:00.308298 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_analytics.sales_final"
[0m22:18:00.308820 [debug] [Thread-2 (]: On model.sales_analytics.stage_sales: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.stage_sales"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`stage_sales`
  OPTIONS()
  as 
SELECT
    order_id,
    product_name,
    amount,
    country,
    order_date,
    
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 Month)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM `ace-amplifier-463712-b1.sales_dataset.raw_sales`;


[0m22:18:00.309048 [debug] [Thread-1 (]: On model.sales_analytics.sales_final: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "model.sales_analytics.sales_final"} */


  create or replace view `ace-amplifier-463712-b1`.`sales_dataset`.`sales_final`
  OPTIONS()
  as SELECT
  country,
  product_name,
  COUNT(order_id) AS total_orders,
  SUM(amount) AS total_revenue,
  
    CASE
        WHEN DATE(order_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 MONTH)
        THEN 'recent'
        ELSE 'historical'
    END AS partition_group

FROM `ace-amplifier-463712-b1.sales_dataset.raw_sales`
GROUP BY country, product_name, partition_group;


[0m22:18:00.309259 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:00.309414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:00.942222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:bd7e4bf4-25d3-49d2-b3be-3be03f5f591e&page=queryresults
[0m22:18:00.945220 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:19961848-581e-4561-8534-d3446e8b0150&page=queryresults
[0m22:18:01.365408 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0f1310>]}
[0m22:18:01.365651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2acc8ac0-d9b7-4852-9a5e-21e8541e9609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b078cb0>]}
[0m22:18:01.366008 [info ] [Thread-2 (]: 2 of 2 OK created sql view model sales_dataset.stage_sales ..................... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m22:18:01.366353 [info ] [Thread-1 (]: 1 of 2 OK created sql view model sales_dataset.sales_final ..................... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m22:18:01.366671 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m22:18:01.366928 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m22:18:01.367595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:01.367883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:01.368014 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m22:18:01.368126 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m22:18:01.368272 [info ] [MainThread]: 
[0m22:18:01.368410 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m22:18:01.368767 [debug] [MainThread]: Command end result
[0m22:18:01.381123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m22:18:01.382345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m22:18:01.385207 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m22:18:01.385345 [info ] [MainThread]: 
[0m22:18:01.385491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:01.385598 [info ] [MainThread]: 
[0m22:18:01.385726 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:18:01.387854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3180501, "process_in_blocks": "0", "process_kernel_time": 0.283572, "process_mem_max_rss": "373030912", "process_out_blocks": "0", "process_user_time": 1.504442}
[0m22:18:01.388054 [debug] [MainThread]: Command `dbt run` succeeded at 22:18:01.388016 after 3.32 seconds
[0m22:18:01.388214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b55bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b01ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bebd50>]}
[0m22:18:01.388353 [debug] [MainThread]: Flushing usage events
[0m22:18:02.215453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:44.628472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b7c50>]}


============================== 11:55:44.632402 | cf79dc13-9d7e-4002-8f30-cae277ee97a0 ==============================
[0m11:55:44.632402 [info ] [MainThread]: Running with dbt=1.10.2
[0m11:55:44.632681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:55:46.419828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf79dc13-9d7e-4002-8f30-cae277ee97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cef6f0>]}
[0m11:55:46.440920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf79dc13-9d7e-4002-8f30-cae277ee97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d05f130>]}
[0m11:55:46.441209 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:55:46.530817 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m11:55:46.582689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:46.582981 [debug] [MainThread]: Partial parsing: updated file: sales_analytics://tests/test.yml
[0m11:55:46.671601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf79dc13-9d7e-4002-8f30-cae277ee97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d0e5d50>]}
[0m11:55:46.703395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m11:55:46.704556 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m11:55:46.721761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf79dc13-9d7e-4002-8f30-cae277ee97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d8e54f0>]}
[0m11:55:46.721992 [info ] [MainThread]: Found 2 models, 2 data tests, 494 macros
[0m11:55:46.722130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf79dc13-9d7e-4002-8f30-cae277ee97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d83fbd0>]}
[0m11:55:46.722824 [info ] [MainThread]: 
[0m11:55:46.722967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:46.723072 [info ] [MainThread]: 
[0m11:55:46.723264 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:46.724990 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m11:55:46.725146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:47.918638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf79dc13-9d7e-4002-8f30-cae277ee97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d75bc70>]}
[0m11:55:47.919645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:47.923336 [debug] [Thread-1 (]: Began running node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m11:55:47.923824 [debug] [Thread-2 (]: Began running node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m11:55:47.924282 [info ] [Thread-1 (]: 1 of 2 START test not_null_sales_final_country ................................. [RUN]
[0m11:55:47.924774 [info ] [Thread-2 (]: 2 of 2 START test not_null_sales_final_total_orders ............................ [RUN]
[0m11:55:47.925342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now test.sales_analytics.not_null_sales_final_country.299e935e0e)
[0m11:55:47.925885 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab'
[0m11:55:47.926330 [debug] [Thread-1 (]: Began compiling node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m11:55:47.926727 [debug] [Thread-2 (]: Began compiling node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m11:55:47.941971 [debug] [Thread-2 (]: Writing injected SQL for node "test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab"
[0m11:55:47.942641 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_analytics.not_null_sales_final_country.299e935e0e"
[0m11:55:47.943261 [debug] [Thread-2 (]: Began executing node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m11:55:47.943471 [debug] [Thread-1 (]: Began executing node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m11:55:47.955902 [debug] [Thread-2 (]: Writing runtime sql for node "test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab"
[0m11:55:47.957041 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_analytics.not_null_sales_final_country.299e935e0e"
[0m11:55:47.957812 [debug] [Thread-2 (]: On test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `ace-amplifier-463712-b1`.`sales_dataset`.`sales_final`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m11:55:47.958108 [debug] [Thread-1 (]: On test.sales_analytics.not_null_sales_final_country.299e935e0e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "node_id": "test.sales_analytics.not_null_sales_final_country.299e935e0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `ace-amplifier-463712-b1`.`sales_dataset`.`sales_final`
where country is null



  
  
      
    ) dbt_internal_test
[0m11:55:47.958314 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:55:47.958489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:49.050703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:12a21a63-cc19-47ac-880a-71714dcdd08c&page=queryresults
[0m11:55:49.453684 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:5393461a-19cf-4c41-8e3c-d878ecb7da67&page=queryresults
[0m11:55:49.617771 [info ] [Thread-1 (]: 1 of 2 PASS not_null_sales_final_country ....................................... [[32mPASS[0m in 1.69s]
[0m11:55:49.618233 [debug] [Thread-1 (]: Finished running node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m11:55:49.964279 [info ] [Thread-2 (]: 2 of 2 PASS not_null_sales_final_total_orders .................................. [[32mPASS[0m in 2.04s]
[0m11:55:49.965760 [debug] [Thread-2 (]: Finished running node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m11:55:49.968086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:49.969001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:49.969435 [debug] [MainThread]: Connection 'test.sales_analytics.not_null_sales_final_country.299e935e0e' was properly closed.
[0m11:55:49.969808 [debug] [MainThread]: Connection 'test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab' was properly closed.
[0m11:55:49.970253 [info ] [MainThread]: 
[0m11:55:49.970711 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m11:55:49.971803 [debug] [MainThread]: Command end result
[0m11:55:49.992692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m11:55:49.994086 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m11:55:49.998292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m11:55:49.998455 [info ] [MainThread]: 
[0m11:55:49.998643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:49.998828 [info ] [MainThread]: 
[0m11:55:49.998990 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:55:50.001980 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.404342, "process_in_blocks": "0", "process_kernel_time": 0.380432, "process_mem_max_rss": "380289024", "process_out_blocks": "0", "process_user_time": 1.6437}
[0m11:55:50.002394 [debug] [MainThread]: Command `dbt test` succeeded at 11:55:50.002328 after 5.40 seconds
[0m11:55:50.002649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108998ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14da028e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14da01860>]}
[0m11:55:50.002856 [debug] [MainThread]: Flushing usage events
[0m11:55:50.659506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:21.903394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107febd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107febc50>]}


============================== 11:56:21.906309 | 3e2d6ed8-b90d-4d93-9da1-5d3e46e8cd8e ==============================
[0m11:56:21.906309 [info ] [MainThread]: Running with dbt=1.10.2
[0m11:56:21.906572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8099', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:23.182789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e2d6ed8-b90d-4d93-9da1-5d3e46e8cd8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070236f0>]}
[0m11:56:23.204279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e2d6ed8-b90d-4d93-9da1-5d3e46e8cd8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14215f130>]}
[0m12:01:47.942317 [error] [MainThread]: Encountered an error:

[0m12:01:47.967811 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:01:47.973962 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 326.0961, "process_in_blocks": "0", "process_kernel_time": 0.30326, "process_mem_max_rss": "361594880", "process_out_blocks": "0", "process_user_time": 1.316953}
[0m12:01:47.977610 [debug] [MainThread]: Command `dbt docs serve` failed at 12:01:47.977250 after 326.10 seconds
[0m12:01:47.978826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14255c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14255c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142521f40>]}
[0m12:01:47.979711 [debug] [MainThread]: Flushing usage events
[0m12:01:48.754173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:23.508218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107923380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddfc50>]}


============================== 12:02:23.511188 | bff1460c-996b-45a9-99e7-03d10682c3d6 ==============================
[0m12:02:23.511188 [info ] [MainThread]: Running with dbt=1.10.2
[0m12:02:23.511462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8099', 'send_anonymous_usage_stats': 'True'}
[0m12:02:24.848706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bff1460c-996b-45a9-99e7-03d10682c3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081176f0>]}
[0m12:02:24.869920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bff1460c-996b-45a9-99e7-03d10682c3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae5b130>]}
[0m12:02:41.340941 [error] [MainThread]: Encountered an error:

[0m12:02:41.348316 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:02:41.355567 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 17.876274, "process_in_blocks": "0", "process_kernel_time": 0.26969, "process_mem_max_rss": "364118016", "process_out_blocks": "0", "process_user_time": 1.283359}
[0m12:02:41.357400 [debug] [MainThread]: Command `dbt docs serve` failed at 12:02:41.357269 after 17.88 seconds
[0m12:02:41.357749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b15c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b15c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b121f40>]}
[0m12:02:41.358156 [debug] [MainThread]: Flushing usage events
[0m12:02:41.940533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:02.955721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10322b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e7c50>]}


============================== 12:03:02.958454 | 9329ba49-5a97-4ea1-8a05-cb2e6c9d4f1f ==============================
[0m12:03:02.958454 [info ] [MainThread]: Running with dbt=1.10.2
[0m12:03:02.958704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 1234', 'send_anonymous_usage_stats': 'True'}
[0m12:03:04.092857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9329ba49-5a97-4ea1-8a05-cb2e6c9d4f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a236f0>]}
[0m12:03:04.114073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9329ba49-5a97-4ea1-8a05-cb2e6c9d4f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c55f130>]}
[0m12:03:41.040695 [error] [MainThread]: Encountered an error:

[0m12:03:41.049343 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:03:41.056945 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 38.127487, "process_in_blocks": "0", "process_kernel_time": 0.236298, "process_mem_max_rss": "362037248", "process_out_blocks": "0", "process_user_time": 1.294941}
[0m12:03:41.058307 [debug] [MainThread]: Command `dbt docs serve` failed at 12:03:41.058196 after 38.13 seconds
[0m12:03:41.058693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca5c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca5c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca21f40>]}
[0m12:03:41.059076 [debug] [MainThread]: Flushing usage events
[0m12:03:41.856805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:56.134819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11001f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ebc50>]}


============================== 12:03:56.137885 | ef6fa2b8-912f-4928-866f-ee99896f7e82 ==============================
[0m12:03:56.137885 [info ] [MainThread]: Running with dbt=1.10.2
[0m12:03:56.138167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8099', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:57.272925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef6fa2b8-912f-4928-866f-ee99896f7e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b276f0>]}
[0m12:03:57.294392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef6fa2b8-912f-4928-866f-ee99896f7e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a5b130>]}
[0m12:04:48.579305 [error] [MainThread]: Encountered an error:

[0m12:04:48.590650 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:04:48.595820 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 52.49005, "process_in_blocks": "0", "process_kernel_time": 0.236963, "process_mem_max_rss": "361332736", "process_out_blocks": "0", "process_user_time": 1.29579}
[0m12:04:48.596790 [debug] [MainThread]: Command `dbt docs serve` failed at 12:04:48.596712 after 52.49 seconds
[0m12:04:48.597136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f5c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f5c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f21f40>]}
[0m12:04:48.597467 [debug] [MainThread]: Flushing usage events
[0m12:04:49.178992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:01.693025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ebc50>]}


============================== 12:05:01.695921 | 452f52e6-891f-46f1-96a4-d16f13ccaf5e ==============================
[0m12:05:01.695921 [info ] [MainThread]: Running with dbt=1.10.2
[0m12:05:01.696190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:02.858261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '452f52e6-891f-46f1-96a4-d16f13ccaf5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043236f0>]}
[0m12:05:02.879801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '452f52e6-891f-46f1-96a4-d16f13ccaf5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f05f130>]}
[0m12:05:02.880098 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:05:02.971842 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m12:05:03.032201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:03.032385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:03.046793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '452f52e6-891f-46f1-96a4-d16f13ccaf5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3d8450>]}
[0m12:05:03.057961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '452f52e6-891f-46f1-96a4-d16f13ccaf5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5eee40>]}
[0m12:05:03.058145 [info ] [MainThread]: Found 2 models, 2 data tests, 494 macros
[0m12:05:03.058272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452f52e6-891f-46f1-96a4-d16f13ccaf5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1a9fd0>]}
[0m12:05:03.059287 [info ] [MainThread]: 
[0m12:05:03.059431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:03.059533 [info ] [MainThread]: 
[0m12:05:03.059718 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:03.061176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ace-amplifier-463712-b1_sales_dataset'
[0m12:05:03.061335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:04.248154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452f52e6-891f-46f1-96a4-d16f13ccaf5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f720050>]}
[0m12:05:04.249287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:04.255619 [debug] [Thread-1 (]: Began running node model.sales_analytics.sales_final
[0m12:05:04.256212 [debug] [Thread-2 (]: Began running node model.sales_analytics.stage_sales
[0m12:05:04.256825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ace-amplifier-463712-b1_sales_dataset, now model.sales_analytics.sales_final)
[0m12:05:04.257515 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.sales_analytics.stage_sales'
[0m12:05:04.258068 [debug] [Thread-1 (]: Began compiling node model.sales_analytics.sales_final
[0m12:05:04.258560 [debug] [Thread-2 (]: Began compiling node model.sales_analytics.stage_sales
[0m12:05:04.268612 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_analytics.sales_final"
[0m12:05:04.270565 [debug] [Thread-2 (]: Writing injected SQL for node "model.sales_analytics.stage_sales"
[0m12:05:04.271796 [debug] [Thread-1 (]: Began executing node model.sales_analytics.sales_final
[0m12:05:04.271998 [debug] [Thread-2 (]: Began executing node model.sales_analytics.stage_sales
[0m12:05:04.272248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:04.272569 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:05:04.273338 [debug] [Thread-1 (]: Finished running node model.sales_analytics.sales_final
[0m12:05:04.273831 [debug] [Thread-2 (]: Finished running node model.sales_analytics.stage_sales
[0m12:05:04.274508 [debug] [Thread-3 (]: Began running node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m12:05:04.274692 [debug] [Thread-4 (]: Began running node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m12:05:04.274901 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.sales_analytics.not_null_sales_final_country.299e935e0e'
[0m12:05:04.275166 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab'
[0m12:05:04.275417 [debug] [Thread-3 (]: Began compiling node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m12:05:04.275655 [debug] [Thread-4 (]: Began compiling node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m12:05:04.282586 [debug] [Thread-3 (]: Writing injected SQL for node "test.sales_analytics.not_null_sales_final_country.299e935e0e"
[0m12:05:04.284503 [debug] [Thread-4 (]: Writing injected SQL for node "test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab"
[0m12:05:04.285286 [debug] [Thread-3 (]: Began executing node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m12:05:04.285456 [debug] [Thread-4 (]: Began executing node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m12:05:04.285656 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:05:04.285843 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:05:04.286271 [debug] [Thread-3 (]: Finished running node test.sales_analytics.not_null_sales_final_country.299e935e0e
[0m12:05:04.286663 [debug] [Thread-4 (]: Finished running node test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab
[0m12:05:04.287213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:04.287397 [debug] [MainThread]: Connection 'model.sales_analytics.sales_final' was properly closed.
[0m12:05:04.287531 [debug] [MainThread]: Connection 'model.sales_analytics.stage_sales' was properly closed.
[0m12:05:04.287660 [debug] [MainThread]: Connection 'test.sales_analytics.not_null_sales_final_country.299e935e0e' was properly closed.
[0m12:05:04.287780 [debug] [MainThread]: Connection 'test.sales_analytics.not_null_sales_final_total_orders.6cd04af2ab' was properly closed.
[0m12:05:04.288218 [debug] [MainThread]: Command end result
[0m12:05:04.325016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m12:05:04.327087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m12:05:04.330525 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/run_results.json
[0m12:05:04.332497 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:05:04.332614 [info ] [MainThread]: Building catalog
[0m12:05:04.334483 [debug] [ThreadPool]: Acquiring new bigquery connection 'ace-amplifier-463712-b1.information_schema'
[0m12:05:04.342352 [debug] [ThreadPool]: On ace-amplifier-463712-b1.information_schema: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "sales_analytics", "target_name": "dev", "connection_name": "ace-amplifier-463712-b1.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `ace-amplifier-463712-b1`.`sales_dataset`.__TABLES__ tables
    left join `ace-amplifier-463712-b1`.`sales_dataset`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `ace-amplifier-463712-b1`.`sales_dataset`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('sales_dataset')
                            and upper(table_name) = upper('sales_final')
                            ) or (
                                upper(table_schema) = upper('sales_dataset')
                            and upper(table_name) = upper('stage_sales')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `ace-amplifier-463712-b1`.`sales_dataset`.INFORMATION_SCHEMA.COLUMNS columns
    join `ace-amplifier-463712-b1`.`sales_dataset`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:05:04.342742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:04.983276 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ace-amplifier-463712-b1&j=bq:EU:33ca588d-3e12-43c2-82f5-b50faca4470e&page=queryresults
[0m12:05:06.676392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:06.688808 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/catalog.json
[0m12:05:06.708940 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/manifest.json
[0m12:05:06.711871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/semantic_manifest.json
[0m12:05:06.712056 [info ] [MainThread]: Catalog written to /Users/abdelrhmanafify/Desktop/test_python/sales_analytics/target/catalog.json
[0m12:05:06.723076 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.057907, "process_in_blocks": "0", "process_kernel_time": 0.31625, "process_mem_max_rss": "375078912", "process_out_blocks": "0", "process_user_time": 1.545034}
[0m12:05:06.723509 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:05:06.723442 after 5.06 seconds
[0m12:05:06.723708 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:05:06.723862 [debug] [MainThread]: Connection 'ace-amplifier-463712-b1.information_schema' was properly closed.
[0m12:05:06.724038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f703a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f703b70>]}
[0m12:05:06.724239 [debug] [MainThread]: Flushing usage events
[0m12:05:07.428620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:31.173838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ebc50>]}


============================== 12:05:31.176127 | 49e44a48-f2ca-48bd-8a1c-a51f408ca22b ==============================
[0m12:05:31.176127 [info ] [MainThread]: Running with dbt=1.10.2
[0m12:05:31.176389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdelrhmanafify/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/abdelrhmanafify/Desktop/test_python/sales_analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8099', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:05:32.074379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e44a48-f2ca-48bd-8a1c-a51f408ca22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080936f0>]}
[0m12:05:32.095977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e44a48-f2ca-48bd-8a1c-a51f408ca22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14325f130>]}
[0m12:07:28.539232 [error] [MainThread]: Encountered an error:

[0m12:07:28.556003 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 766, in __init__
    self.handle()
    ~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/server.py", line 436, in handle
    self.handle_one_request()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
KeyboardInterrupt

[0m12:07:28.561593 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 117.4129, "process_in_blocks": "0", "process_kernel_time": 0.21772, "process_mem_max_rss": "360333312", "process_out_blocks": "0", "process_user_time": 1.288441}
[0m12:07:28.562931 [debug] [MainThread]: Command `dbt docs serve` failed at 12:07:28.562819 after 117.41 seconds
[0m12:07:28.563419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14355c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14355c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143522210>]}
[0m12:07:28.563728 [debug] [MainThread]: Flushing usage events
[0m12:07:29.298099 [debug] [MainThread]: An error was encountered while trying to flush usage events
